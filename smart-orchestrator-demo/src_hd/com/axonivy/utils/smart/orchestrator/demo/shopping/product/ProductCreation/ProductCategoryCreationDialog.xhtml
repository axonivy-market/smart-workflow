<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:cc="http://xmlns.jcp.org/jsf/composite" xmlns:ic="http://ivyteam.ch/jsf/component"
  xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions"
  xmlns:c="http://xmlns.jcp.org/jsp/jstl/core" xmlns:jsf="http://xmlns.jcp.org/jsf">

<ui:composition>
  <p:dialog id="create-category-dialog" widgetVar="create-category-dialog" width="50%" height="50%"
   modal="true" dynamic="true" responsive="true"
   header="#{ivy.cms.co('/Dialogs/com/axonivy/utils/smart/orchestrator/demo/shopping/product/ProductCreation/ProductCategoryCreation')}" appendTo="@(body)">
    <h:form id="create-category-form" styleClass="p-fluid">
      <!-- Category Information Section -->
      <div class="mb-4">
        <h3 class="text-900 font-semibold mb-3 flex align-items-center gap-2">
          <i class="pi pi-tags text-primary"></i>
          #{ivy.cms.co('/Dialogs/com/axonivy/utils/smart/orchestrator/demo/shopping/product/ProductCreation/CategoryInformation')}
        </h3>

        <div class="formgrid grid">
          <h:panelGroup layout="block" styleClass="field col-12"
            rendered="#{not empty data.similiarProductCategories}">
             <h:outputText value="#{ivy.cms.co('/Dialogs/com/axonivy/utils/smart/orchestrator/demo/shopping/product/ProductCreation/ChooseExistingCategory')}" />
          </h:panelGroup>
          <h:panelGroup layout="block" styleClass="field col-12"
            rendered="#{not empty data.similiarProductCategories}">
            <p:selectOneMenu value="#{data.selectedCategory}" converter="pojoConverter">
              <f:selectItem noSelectionOption="true" itemValue="#{null}" />
              <f:selectItems value="#{data.similiarProductCategories}" var="category"
                itemValue="#{category}" itemLabel="#{category.name}" />
              <p:ajax event="itemSelect" process="@form" update="@form" listener="#{logic.onSelectCategory}" />
            </p:selectOneMenu>
          </h:panelGroup>
          <div class="field col-12">
            <div class="formgrid grid flex align-items-center">
              <div class="field col-12 md:col-3 mb-1">
                <p:outputLabel value="#{ivy.cms.co('/Dialogs/com/axonivy/utils/smart/orchestrator/demo/shopping/product/ProductCreation/CategoryName')}" for="category-name" />
              </div>
              <div class="field col-12 md:col-9 mb-1">
                <p:inputText id="category-name" value="#{data.response.product.category.name}" 
                             styleClass="w-full"
                             required="true" />
              </div>
            </div>
          </div>
          <div class="field col-12">
            <div class="formgrid grid flex align-items-top">
              <div class="field col-12 md:col-3 mb-1">
                <p:outputLabel value="#{ivy.cms.co('/Dialogs/com/axonivy/utils/smart/orchestrator/demo/shopping/product/ProductCreation/Description')}" for="category-description" />
              </div>
              <div class="field col-12 md:col-9 mb-1">
                <p:inputTextarea id="category-description" value="#{data.response.product.category.description}" 
                                 styleClass="w-full"
                                 rows="4" />
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="flex justify-content-end gap-2 pt-3 border-top-1 surface-border">
        <p:commandButton value="#{ivy.cms.co('/Labels/Cancel')}" type="button" 
                        onclick="PF('create-category-dialog').hide();" 
                        styleClass="p-button-outlined" 
                        icon="pi pi-times" />
        <p:commandButton value="#{ivy.cms.co('/Labels/Resolve')}" styleClass="p-button-success" icon="pi pi-check"
                        actionListener="#{logic.createProductCategory}"
                        process="@(form)"
                        update="#{p:resolveFirstComponentWithId('result-form', view).clientId}"
                        oncomplete="PF('create-category-dialog').hide();" />
      </div>
    </h:form>
  </p:dialog>
  </ui:composition>
</html>