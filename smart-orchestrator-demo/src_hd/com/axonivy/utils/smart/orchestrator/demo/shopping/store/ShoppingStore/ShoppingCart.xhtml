<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:cc="http://xmlns.jcp.org/jsf/composite" xmlns:ic="http://ivyteam.ch/jsf/component"
  xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions"
  xmlns:c="http://xmlns.jcp.org/jsp/jstl/core" xmlns:jsf="http://xmlns.jcp.org/jsf">

<ui:composition>
  <p:dialog header="#{ivy.cms.co('/Dialogs/com/axonivy/utils/smart/orchestrator/demo/shopping/store/ShoppingStore/ShoppingCart')}" 
            widgetVar="cart-dialog" 
            modal="true"
            width="80%"
            dynamic="true"
            appendTo="@(body)"
            styleClass="cart-modal-dialog">
    <h:form class="cart-content">
      <h:panelGroup rendered="#{empty data.cartItems}">
        <div class="empty-cart text-center p-6">
          <i class="pi pi-shopping-cart text-8xl text-gray-400 mb-4"></i>
          <h4 class="text-2xl font-bold text-900 mb-3">#{ivy.cms.co('/Dialogs/com/axonivy/utils/smart/orchestrator/demo/shopping/store/ShoppingStore/YourCartIsEmpty')}</h4>
          <p class="text-gray-600 mb-5 text-lg">#{ivy.cms.co('/Dialogs/com/axonivy/utils/smart/orchestrator/demo/shopping/store/ShoppingStore/StartShopping')}</p>
          <p:link value="#{ivy.cms.co('/Labels/Close')}" 
                 styleClass="cart-close-link"
                 onclick="PF('cart-dialog').hide(); return false;" />
        </div>
      </h:panelGroup>
      
      <h:panelGroup rendered="#{not empty data.cartItems}">
        <div class="cart-items">
          <p:dataTable value="#{data.cartItems}" 
                      var="cartItem" 
                      styleClass="cart-table p-datatable-striped p-datatable-hoverable-rows"
                      emptyMessage="#{ivy.cms.co('/Dialogs/com/axonivy/utils/smart/orchestrator/demo/shopping/store/ShoppingStore/NoItemsInCart')}"
                      rowStyleClass="cart-row">
            <p:column headerText="#{ivy.cms.co('/Dialogs/com/axonivy/utils/smart/orchestrator/demo/shopping/store/ShoppingStore/Product')}" styleClass="product-column" width="70%">
              <div class="cart-product-info flex align-items-center gap-3">
                <h:panelGroup rendered="#{not empty cartItem.product.imageUrl}">
                  <img src="#{cartItem.product.imageUrl}" 
                       alt="#{cartItem.product.name}" 
                       class="cart-product-image" />
                </h:panelGroup>
                <h:panelGroup rendered="#{empty cartItem.product.imageUrl}">
                  <div class="cart-no-image">
                    <i class="pi pi-image text-gray-400"></i>
                  </div>
                </h:panelGroup>
                <div class="product-details">
                  <h5 class="product-name font-bold text-900 mb-1">#{cartItem.product.name}</h5>
                  <p class="unit-price text-sm text-primary font-medium mb-0">$#{cartItem.product.unitPrice}</p>
                </div>
              </div>
            </p:column>
            
            <p:column headerText="#{ivy.cms.co('/Dialogs/com/axonivy/utils/smart/orchestrator/demo/shopping/store/ShoppingStore/Total')}" styleClass="text-center">
              <span class="item-total font-bold text-primary">$#{cartItem.formattedTotalPrice}</span>
            </p:column>
            
            <p:column headerText="#{ivy.cms.co('/Dialogs/com/axonivy/utils/smart/orchestrator/demo/shopping/store/ShoppingStore/Quantity')}" styleClass="text-center">
              <span class="quantity-display font-bold text-900">#{cartItem.quantity}</span>
            </p:column>
            
            <p:column headerText="" styleClass="text-center">
              <div class="flex align-items-center justify-content-center gap-2">
                <p:commandButton icon="pi pi-minus" 
                                styleClass="quantity-btn-minus"
                                actionListener="#{logic.decreaseQuantity(cartItem)}"
                                update="@form" />
                <p:commandButton icon="pi pi-plus" 
                                styleClass="quantity-btn-plus"
                                actionListener="#{logic.increaseQuantity(cartItem)}"
                                update="@form" />
              </div>
            </p:column>
          </p:dataTable>
        </div>
        
        <div class="cart-summary mt-5 p-4 border-round bg-white shadow-1">
          <div class="flex justify-content-between align-items-center">
            <h4 class="cart-total-text">#{ivy.cms.co('/Dialogs/com/axonivy/utils/smart/orchestrator/demo/shopping/store/ShoppingStore/Total')}: $#{logic.getCartTotal()}</h4>
            <div class="flex gap-3">
              <p:link value="#{ivy.cms.co('/Labels/Close')}" 
                     styleClass="cart-close-link"
                     onclick="PF('cart-dialog').hide(); return false;" />
              <p:commandButton value="#{ivy.cms.co('/Labels/Finish')}" 
                              styleClass="p-button-primary p-button-lg"
                              disabled="#{empty data.cartItems}" />
            </div>
          </div>
        </div>
      </h:panelGroup>
    </h:form>
  </p:dialog>
</ui:composition>
</html>